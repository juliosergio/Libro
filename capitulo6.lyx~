#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass book
\use_default_options true
\begin_modules
knitr
\end_modules
\maintain_unincluded_children false
\language spanish-mexico
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Graficación con R
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<widthcap6, include=F>>=
\end_layout

\begin_layout Plain Layout

options('width')
\end_layout

\begin_layout Plain Layout

options(width=60)
\end_layout

\begin_layout Plain Layout

options('width')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

<<set-optionsCap6, echo=FALSE, cache=FALSE>>=
\end_layout

\begin_layout Plain Layout

read_chunk('EjCap5.R')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Una de las grandes virutdes del lenguaje R, es la facilidad que ofrece para
 presentar la información correspondiente a los datos que maneja o a los
 cálculos que desarrolla, de una manera gráfica.
 El lenguaje cuenta, no con uno, sino con varios sistemas, en general separados,
 para organizar o especificar visualizaciones gráficas.
 En este capítulo se revisará uno de ellos, el sistema gráfico básico, que
 es el que está inmediatamente disponible en la instalación inicial del
 lenguaje.
\end_layout

\begin_layout Section
Motivación
\end_layout

\begin_layout Standard
Anteriormente, en el capítulo 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Escritura-de-Funciones"

\end_inset

, se vio colateralmente la manera para producir histogramas sencillos, a
 partir de un conjunto de datos.
 Sin embargo, en ese capítulo, la producción de estos histogramas, se hizo
 sin alterar o controlar la apariencia final del gráfico resultante; esto
 es, se dispuso de las opciones que el sistema otorga por ausencia, o por
 
\emph on
default
\emph default
.
 No obstante, la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ajuste-de-datos"

\end_inset

 de ese capítulo, exhibe una apariencia que no es generada por el código
 de ejemplo que se muestra allí mismo, en la sección 
\begin_inset CommandInset ref
LatexCommand vref
reference "El-resultado-del-código"

\end_inset

.
 La producción de la gráfica en cuestión, requiere de la alteración de las
 opciones que el sistema ofrece por ausencia.
 
\end_layout

\begin_layout Standard
En el código que se muestra a continuación se puede observar cómo se modifican
 algunas de las opciones de apariencia, para generar el gráfico deseado,
 que se presenta nuevamente en la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Gráfico-con-atributos"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<EjCap5, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

<<Grafico0, eval=F, tidy=F>>=
\end_layout

\begin_layout Plain Layout

hist(pp$Precip, freq=F, breaks=15,
\end_layout

\begin_layout Plain Layout

     col="blueviolet", # Color de las barras
\end_layout

\begin_layout Plain Layout

     density=30, # Densidad de sombreado de las barras
\end_layout

\begin_layout Plain Layout

     main="Histograma y densidad Gamma", # Titulo
\end_layout

\begin_layout Plain Layout

     xlab="precipitacion (mm)", # Etiqueta del eje X
\end_layout

\begin_layout Plain Layout

     ylab="Densidad") # Etiqueta del eje Y
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

curve(dgammaX, add=T,
\end_layout

\begin_layout Plain Layout

     col="green", # Color de la curva
\end_layout

\begin_layout Plain Layout

     lwd=3) # Ancho de linea de la curva
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Grafico1, ref.label='Grafico0', echo=FALSE, fig.width=4, fig.height=4, fig.show='h
old', out.width='.8
\backslash

\backslash
linewidth'>>=
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Gráfico-con-atributos"

\end_inset

Gráfico con atributos
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Hasta aquí, se ha visto como producir histogramas y curvas.
 Existen varios otros tipos de gráficos, además de que hay muchas otras
 opciones para manipular su apariencia; algunos de estos tipos, así como
 algunas de sus opciones, se revisarán en las siguientes secciones del presente
 capítulo.
\end_layout

\begin_layout Section
La función más básica de graficación: 
\family typewriter
plot()
\end_layout

\begin_layout Standard
La función más simple para graficar es 
\family typewriter
plot()
\family default
.
 Antes de explicar sus posibilidades, veremos qué es lo que hace en el caso
 más sencillo.
 Para ello se empleará el mismo conjunto de datos último ejemplo del capítulo
 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Escritura-de-Funciones"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Scatter0, eval=F, tidy=F>>=
\end_layout

\begin_layout Plain Layout

plot(pp$Precip) # Produce un grafico de "dispersion"
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
El resultado de la operación anterior se puede ver en la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Un-sencillo-gráfico"

\end_inset

, con algunas anotaciones acerca de los valores que ha tomado el lenguaje
 por omisión.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Scatter1.jpg
	lyxscale 60
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Un-sencillo-gráfico"

\end_inset

Un sencillo gráfico de 
\emph on
dispersión
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
En general, la función 
\family typewriter
plot()
\family default
 toma como argumentos dos vectores de la misma dimensión, uno para los valores
 de las abscisas, 
\family typewriter
x
\family default
, y otro para los valores de las ordenadas, 
\family typewriter
y
\family default
.
 Sin embargo, cuando se omite uno de ellos, el lenguaje 
\emph on
entiende
\emph default
 que las abscisas serían simplemente los índices de los elementos en el
 vector provisto, y que las ordenadas serán, por tanto, cada uno de los
 elementos del vector.
 De igual manera, el lenguaje 
\emph on
supone
\emph default
 que lo que se quiere graficar son los puntos como tal y con el color y
 tipo de símbolo seleccionados por omisión.
 La función 
\family typewriter
plot()
\family default
 tiene una gran variedad de argumentos que permiten cambiar ese comportamiento
 por omisión y que pueden ser consultados en línea mediante la instrucción
 
\family typewriter

\begin_inset Quotes eld
\end_inset

?plot
\begin_inset Quotes erd
\end_inset


\family default
.
 
\end_layout

\begin_layout Standard
En seguida, se grafica la misma información que en el gráfico anterior,
 pero ahora como líneas azules, y considerando como abscisas los años de
 los datos, que en este caso son los nombres de los renglones del 
\emph on
data frame
\emph default
 que contiene los datos, 
\family typewriter
pp
\family default
.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<BlueLines0, eval=F, tidy=F>>=
\end_layout

\begin_layout Plain Layout

# Para el manejo de etiquetas especiales,
\end_layout

\begin_layout Plain Layout

# con caracteres "raros para el Ingles", 
\end_layout

\begin_layout Plain Layout

lab <- "Años" # Etiqueta para las abscisas
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

plot(as.numeric(rownames(pp)), # las abscisas
\end_layout

\begin_layout Plain Layout

     pp$Precip, # las ordenadas
\end_layout

\begin_layout Plain Layout

     type="l",  # tipo de grafico: lineas
\end_layout

\begin_layout Plain Layout

     col="blue",  # color: azul
\end_layout

\begin_layout Plain Layout

     main="Precipitaciones, Octubre", # Titulo
\end_layout

\begin_layout Plain Layout

     sub="Estado de Guerrero", # Subtitulo
\end_layout

\begin_layout Plain Layout

     xlab=lab, # etiqueta eje X
\end_layout

\begin_layout Plain Layout

     ylab="Precipitacion") # etiqueta eje Y
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
El resultado correspondiente al código anterior se muestra en la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Gráfico-de-líneas"

\end_inset

.
 Aquí, como ejemplo, se ha recurrido a proveer la etiqueta 
\begin_inset Quotes eld
\end_inset

Años
\begin_inset Quotes erd
\end_inset

, para el eje de las abscisas, por fuera del llamado a la función 
\family typewriter
plot()
\family default
, porque de otra manera el lenguaje no interpretaría correctamente que la
 tabla de codificación de caracteres es 
\begin_inset Quotes eld
\end_inset

UTF-8
\begin_inset Quotes erd
\end_inset

.
 También, cabe notar que los nombres de los renglones se han convertido
 a tipo numérico, ya que el vector 
\family typewriter
rownames(pp)
\family default
 es de cadenas de caracteres.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<BlueLines1, ref.label='BlueLines0', echo=FALSE, fig.width=4, fig.height=4,
 fig.show='hold', out.width='.8
\backslash

\backslash
linewidth'>>=
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Gráfico-de-líneas"

\end_inset

Gráfico de líneas con la misma información que en la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Un-sencillo-gráfico"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
En general, el gráfico más simple que se puediera ocurrir es probablemente
 un gráfico 
\emph on
x-y
\emph default
 resultante de la aplicación de una función; por ejemplo, el gráfico de
 las áreas de los círculos, en función de sus radios.
 A continuación se muestra el código para producir ese gráfico para once
 radios: del 0 al 10.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Areas0, eval=F, tidy=F>>=
\end_layout

\begin_layout Plain Layout

radio <- 0:10 # Vector de radios
\end_layout

\begin_layout Plain Layout

area <- pi*radio^2 # Vector de areas
\end_layout

\begin_layout Plain Layout

tit <- "Áreas de círculos" # Titulo del grafico
\end_layout

\begin_layout Plain Layout

plot(radio, area, # x=radio y=area
\end_layout

\begin_layout Plain Layout

     type="b", # "both", puntos y lineas
\end_layout

\begin_layout Plain Layout

     main=tit,
\end_layout

\begin_layout Plain Layout

     xlab="Radio (r)",
\end_layout

\begin_layout Plain Layout

     ylab=expression(Area == pi*r^2), # Una expresion
\end_layout

\begin_layout Plain Layout

     col="orange", # color (naranja)
\end_layout

\begin_layout Plain Layout

     pch=20) # tipo de simbolo para punto
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
El resultado del código anterior se puede observar en la Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Gráfico-de-radios"

\end_inset

.
 En este gráfico se ha añadido como título del eje de las ordenadas una
 expresión matemática.
 Mediante el uso de la función 
\family typewriter
expresion()
\family default
, el lenguaje se encarga de traducir la expresión a su representación matemática
 simbólica.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Areas1, ref.label='Areas0', echo=FALSE, fig.width=4, fig.height=4, fig.show='hold'
, out.width='.8
\backslash

\backslash
linewidth'>>=
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Gráfico-de-radios"

\end_inset

Gráfico de radios contra áreas de círculos
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nótese que en el código anterior, se ha señalado el tipo de gráfico mediante
 el argumento 
\family typewriter
type=
\begin_inset Quotes erd
\end_inset

b
\begin_inset Quotes erd
\end_inset


\family default
; esto es, se graficarán tanto los puntos como las líneas que los unen.
 El argumento 
\family typewriter
type
\family default
 de la función 
\family typewriter
plot()
\family default
 permite modificar los tipos de gráficos que se pueden producir.
 En la tabla que se da a continuación, se describen dichos tipos de gráficos.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
type=
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tipo de gráfico
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

p
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
puntos (gráfico de dispersión)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

l
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
líneas
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

b
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ambos (puntos y líneas)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

c
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sólo las líneas de 
\family typewriter
type=
\begin_inset Quotes erd
\end_inset

b
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

o
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
puntos y líneas, sobre graficados
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

h
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
agujas (tipo histograma)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

s
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
función escalera (horizontal a vertical)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

S
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
función escalera (vertical a horizontal)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
\begin_inset Quotes eld
\end_inset

n
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
no-grafica (sólo se grafican referencias)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
La Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Graficos-que-se"

\end_inset

 muestra la apariencia de cada uno de esos tipos, para los mismos datos
 de la figura anterior.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<GrTypes, echo=FALSE, fig.width=4, fig.height=7, fig.show='hold', out.width='1.0
\backslash

\backslash
linewidth'>>=
\end_layout

\begin_layout Plain Layout

ppar <- par(mfrow=c(5,2),
\end_layout

\begin_layout Plain Layout

            mar=c(2.1, 2.1, 2.1, 1.1))
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="p", pch=20, main='type="p"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="l", pch=20, main='type="l"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="b", pch=20, main='type="b"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="c", pch=20, main='type="c"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="o", pch=20, main='type="o"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="h", pch=20, main='type="h"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="s", pch=20, main='type="s"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="S", pch=20, main='type="S"') 
\end_layout

\begin_layout Plain Layout

plot(radio,area, type="n", pch=20, main='type="n"')
\end_layout

\begin_layout Plain Layout

par(ppar)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Graficos-que-se"

\end_inset

Tipos de gráficos que se pueden producir con 
\family typewriter
plot()
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_body
\end_document
